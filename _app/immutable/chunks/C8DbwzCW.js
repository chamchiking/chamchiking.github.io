import{b as A,h as o,a as I,E as N,ay as R,az as m,j as x,at as v,aw as h,c as g,av as p,d as S,a9 as k,n as b,u as q,A as w,aq as D,x as F,a2 as L}from"./X0wdYxlf.js";function C(s,a,u=!1){o&&I();var e=s,n=null,r=null,i=k,y=u?N:0,c=!1;const E=(l,t=!0)=>{c=!0,_(t,l)},_=(l,t)=>{if(i===(i=l))return;let d=!1;if(o){const T=e.data===R;!!i===T&&(e=m(),x(e),v(!1),d=!0)}i?(n?h(n):t&&(n=g(()=>t(e))),r&&p(r,()=>{r=null})):(r?h(r):t&&(r=g(()=>t(e))),n&&p(n,()=>{n=null})),d&&v(!0)};A(()=>{c=!1,a(E),c||_(null,null)},y),o&&(e=S)}function j(s,a,u){if(s==null)return a(void 0),b;const e=q(()=>s.subscribe(a,u));return e.unsubscribe?()=>e.unsubscribe():e}let f=!1;function H(s,a,u){const e=u[a]??(u[a]={store:null,source:D(void 0),unsubscribe:b});if(e.store!==s)if(e.unsubscribe(),e.store=s,s==null)e.source.v=void 0,e.unsubscribe=b;else{var n=!0;e.unsubscribe=j(s,r=>{n?e.source.v=r:L(e.source,r)}),n=!1}return F(e.source)}function O(){const s={};return w(()=>{for(var a in s)s[a].unsubscribe()}),s}function P(s){var a=f;try{return f=!1,[s(),f]}finally{f=a}}export{H as a,P as c,C as i,O as s};
